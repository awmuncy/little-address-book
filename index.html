<!DOCTYPE html>
<html>
<head>
	<title>My Little Address Book</title>
	 <link rel="stylesheet" type="text/css" href="style.css">

</head>
<body>
	<header>
		<h1>My Little Address Book</h1>
	</header>
	<main>


		<ul class="contacts-list">

		</ul>
		<form id="new-contact">			
			<input class="first-name" type="text" name="first_name" placeholder="First Name">
			<input class="last-name" type="text" name="last_name" placeholder="Last Name">
			<input class="email" type="email" name="email" placeholder="Email">
			<button type="submit" class="submit-contact">Add Contact</button>
		</form>
	</main>
	<footer>
		Made by <a href="https://www.allenmuncy.com">Allen Muncy</a>
	</footer>

	
	<script src="app.js"></script>
	<script src="service-worker.js"></script>
	<script>
		window.isUpdateAvailable = new Promise(function(resolve, reject) {
			navigator.serviceWorker.register('service-worker.js')
				.then(reg => {
					reg.onupdatefound = () => {
						const installingWorker = reg.installing;
						installingWorker.onstatechange = () => {
							switch (installingWorker.state) {
								case 'installed':
									if (navigator.serviceWorker.controller) {
										// new update available
										resolve(true);
									} else {
										// no update available
										resolve(false);
									}
									break;
							}
						};
					};
				})
				.catch(err => console.error('[SW ERROR]', err));
			
		});
		window['isUpdateAvailable']
		.then(isAvailable => {
			if (isAvailable) {
				if(confirm("A new version of the app is available. Refresh?")) {
					navigator.serviceWorker.controller.postMessage({action: "skipWaiting"});
					location.reload();
				}
			}
		});
	</script>
</body>
</html>